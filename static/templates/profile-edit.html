<!DOCTYPE html>
<html>
  <head>
     <title>ClubHub.com</title>
  </head>
  <body>
     <style>
        td.main{
           border-collapse: collapse;
           padding: 2rem;
        }
        .scrollable-menu-dropdown {
            height: auto;
            max-height: 200px;
            overflow-x: hidden;
         }
         label.strikethrough:hover{
            text-decoration: line-through;
         }
         a.edit{
            background-color: rgb(212, 212, 212);
            margin-top: 10px;
            border-radius: 10px;
            padding-left:0.5rem;
            padding-right:0.5rem;
            padding-top:0.1rem;
            padding-bottom:0.1rem;
         }
     </style>
     {% include 'header.html' %} <br>

     <table>
           <td class="main">
               <h1>Your Profile</h1>
               Netid: {{username}} <br>
               Name: {{name}}<br>
               Class Year: {{year}}<br>
               Subscribed Clubs:
               {% if subs|length==0: %}
               <br><em>&emsp;&emsp;Subscribe to clubs to see them listed here!</em><br>
               {% else: %}
               <a class="edit"href="profile">Stop editing</a><br>
               <div style="color:red;size:small;">*Click on each club to unsubscribe</div>
               <ul style="margin-bottom:0;">
               {% for each in subs: %}
                  <li><label class="strikethrough" onclick="unsubscribe('{{each[1]}}')">{{each[0]}}</label>
                     <!--
                     <small class="strikethrough" onclick="unsubscribe('{{each[1]}}')"><em>Unsubscribe</em></small></li>-->
               {% endfor %}
               </ul>
               {% endif %}
                        <div class="btn-group dropright" style="padding-top:10px;">
                        <button class="btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" 
                                    data-toggle="dropdown"aria-expanded="false">Unsubscribe From Tags</button>
                        <ul id="tagdropdown" class="dropdown-menu scrollable-menu-dropdown">
                           <li><a class="dropdown-item" style="color:red; font-size:x-small;">*Unsubscribing to a tag will unsubscribe you to all clubs containing the specified tag.</a></li>
                           {% for tag in tags: %}
                           <li onClick="unsub_tag('{{tag[0]}}')">
                              <a class="dropdown-item" style="white-space:normal;">
                                 <label for={{tag[0]}} onClick="unsub_tag('{{tag[0]}}')">{{tag[0]}}</label>
                              </a>
                           </li>
                           {% endfor %}
                        </ul>
                        </div> <br>
               </div>


               <!--small><em>&emsp;&emsp;You are automatically subscribed to any clubs for which you are an officer.</em></small>
               <br--><br>

               Officer of Clubs:<br>

               {% if officerships|length==0: %}
               <em>&emsp;&emsp;You are not an officer of any clubs.</em>
               {% else: %}
               <ul>
               {% for each in officerships: %}
                  <li>{{each}}&nbsp;&nbsp;
                     <small><em>
                     <a href="/announce?clubid={{officerships[each]}}"> Send announcement </a>
                     &nbsp;&nbsp;&nbsp;
                     <a href="/edit_club?clubid={{officerships[each]}}"> Edit your club </a>
                     </em></small>
                  </li>
               {% endfor %}
               </ul>
               {% endif %}

           </td>
  </table>

     {% include 'footer.html' %}

     <script>
         function unsubscribe(input) {

            fetch("/subscribe?subscribe=0&clubid="+input)
            .then(() => {location.reload();})

         }

         function unsub_tag(tag) {
            fetch("/subscribe_tag?tag="+tag+"&subscribe_tag=0")
            .then((response) => response.text())
            .then((text) => {
               if (text=="success") {
                  alert("Successfully unsubscribed from tag " + tag + "!")
               }
               else alert("Error - unable to unsubscribe from tag " + tag)
            })
            .then(() => {location.reload()});
         }
     </script>

     <!---Keep the JS below at the bottom of body. For loading bootstrap-->
     <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
     <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.min.js" integrity="sha384-IDwe1+LCz02ROU9k972gdyvl+AESN10+x7tBKgc9I5HFtuNz0wWnPclzo6p9vxnk" crossorigin="anonymous"></script>
     <script type="text/javascript" src="Scripts/jquery-2.1.1.min.js"></script>
  </body>
</html>